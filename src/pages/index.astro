---
import Welcome from "../components/Home/Welcome.astro";
import Description from "../components/Home/Description.astro";
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";
---

<script>
  import gsap from "gsap";
  import ScrollTrigger from "gsap/ScrollTrigger";
  import SplitType from "split-type";
  import Lenis from "@studio-freight/lenis";

  gsap.registerPlugin(ScrollTrigger);

  const lenis = new Lenis();
  lenis.on("scroll", ScrollTrigger.update);

  function raf(time: number) {
    lenis.raf(time);
    requestAnimationFrame(raf);
  }
  requestAnimationFrame(raf);

  const splitTypes = document.querySelectorAll(".reveal-type");

  splitTypes.forEach((el) => {
    if (!(el instanceof HTMLElement)) return;

    const bg = el.dataset.bgColor || "##F8F8F7";
    const fg = el.dataset.fgColor || "#000000";

    const text = new SplitType(el, { types: "chars" });

    gsap.fromTo(
      text.chars,
      { color: bg },
      {
        color: fg,
        duration: 0.3,
        stagger: 0.02,
        scrollTrigger: {
          trigger: el,
          start: "top 80%",
          end: "top 20%",
          scrub: true,
          toggleActions: "play play reverse reverse",
        },
      }
    );
  });
</script>
<Layout>
  <Welcome />
  <Description />
</Layout>
